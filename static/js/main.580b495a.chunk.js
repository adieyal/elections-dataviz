(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{43:function(e,t,n){},49:function(e,t,n){},52:function(e,t,n){},54:function(e,t,n){},58:function(e,t,n){e.exports=n(94)},63:function(e,t,n){},65:function(e,t,n){},92:function(e,t,n){},94:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(18),o=n.n(r),l=(n(63),n(7)),c=n(8),s=n(10),u=n(9),p=n(11),m=(n(65),n(4)),d=n(2),v=n(43),y=n.n(v);function g(e,t,n,a,i){i||(i={}),i.chartType||(i.chartType="Race For Votes"),i.yAxisLabel||(i.yAxisLabel="PERCENTAGE VOTES"),i.yValue||(i.yValue=function(e){return e.percOfVotes}),i.yValueFormat||(i.yValueFormat=function(e){return e+"%"});var r,o=["blue","yellow","red"],l=e.append("svg").attr("width",parseInt(t)+70).attr("height",parseInt(n)+20);r=document.getElementsByClassName("tooltip")[0]?d.j(".tooltip"):d.j("body").append("div").attr("class",a("tooltip")).style("opacity",0);var c=d.h().rangeRound([70,t]),s=d.i().rangeRound([n,20]);l.append("g").attr("transform","translate(20,"+(n/2+10)+")").append("text").attr("class",a("percentage-label")).attr("transform","rotate(-90)").text(i.yAxisLabel).attr("text-anchor","middle"),l.append("g").attr("class","x axis").attr("transform","translate(0,"+n+")"),l.append("g").attr("class","y axis").attr("transform","translate(70, 0)");var u=l.append("g").attr("class",a("bar-container")),p=l.append("g").attr("class",a("bartext-container"));this.draw=function(e,t){var m={};function v(e,t){return m[e.split("/")[0]]||o[t%o.length]}t&&t.data.allParties.edges&&t.data.allParties.edges.forEach(function(e){m[e.node.name]=e.node.colour}),c.domain(e.map(function(e){return e.name}));var y=[0,100];i.dynamicYAxisFromValues&&(y[1]=d.g(e,function(e){return i.yValue(e)})),s.domain(y),l.select(".x.axis").transition().duration(300).call(d.a(c)),l.select(".y.axis").transition().duration(300).call(d.b(s).ticks(6).tickFormat(function(e){return i.yValueFormat(e)}));var g=u.selectAll(".".concat(a("bar"))).data(e);g.exit().transition().duration(300).attr("y",function(e){return s(0)}).attr("height",0).style("fill-opacity",1e-6).remove(),g.enter().append("rect").attr("class",a("bar")).attr("x",function(e){return c(e.name)+c.bandwidth()/20}).attr("width",9*c.bandwidth()/10).attr("fill",function(e,t){return v(e.partyInfo.name,t)}).on("mousemove",function(e){var t;d.j(this).attr("opacity",.8),r.transition().duration(200).style("opacity",.9),r.html((t=e.partyInfo.name,t.split("/")[0].toLowerCase().replace(/\b\w/g,function(e){return e.toUpperCase()})+" : "+i.yValueFormat(i.yValue(e)))).style("left",d.c.pageX+"px").style("top",d.c.pageY-28+"px")}).on("mouseout",function(e){d.j(this).attr("opacity",1),r.transition().duration(200).style("opacity",0)}).attr("y",function(e){return s(0)}).attr("height",0),u.selectAll(".".concat(a("bar"))).data(e).attr("fill",function(e,t){return v(e.partyInfo.name,t)}).transition().duration(300).attr("y",function(e){return s(Number(i.yValue(e)))}).attr("height",function(e){return n-s(Number(i.yValue(e)))});var h=p.selectAll(".".concat(a("bartext"))).data(e);h.exit().transition().duration(300).attr("y",function(e){return s(0)-5}).style("fill-opacity",1e-6).remove(),h.enter().append("text").attr("class",a("bartext")).attr("x",function(e){return c(e.name)+c.bandwidth()/2}).attr("text-anchor","middle").attr("font-size","12px").attr("y",function(e){return s(0)-5}),p.selectAll(".".concat(a("bartext"))).data(e).text(function(e){return i.yValueFormat(i.yValue(e))}).transition().duration(300).attr("y",function(e){return s(Number(i.yValue(e)))-5})},this.destroy=function(){l.remove()}}var h="region-change",f="barchart-preview",b="map-preview",N=n(5),E=n(99),C=n(15),w=n(100),T=n(6),j=n.n(T);new E.a({link:new C.a({uri:"https://elections2019.xyz/graphql",useGETForQueries:!0,headers:{"Content-Type":"application/graphql"}}),cache:new w.a});function O(){var e=Object(N.a)(['\n          {\n            allVotingDistrictBallots( \n            event_Description:"','",\n            location_Ward_Municipality_Name_Icontains:"','") {\n              edges{\n                node{\n                  location {\n                    vdNumber\n                  }\n                  partyResults {\n                    edges{\n                      node{\n                        party{\n                          name\n                          abbreviation\n                        }\n                      }\n                    }  \n                  }\n                }\n              }\n            }\n          }\n          ']);return O=function(){return e},e}function k(){var e=Object(N.a)(['\n        {\n          allMunicipalBallots(\n            event_Description:"','",\n            location_Province_Name:"','"\n          ) {\n            edges{\n              node {\n                partyResults {\n                  edges{\n                    node{\n                      party {               \n                        name\n                        abbreviation\n                      }\n                      validVotes\n                      percOfVotes\n                    }\n                  }\n                  \n                }\n                location {\n                  code\n                  name\n                  longName\n                }\n              }\n            }\n          }\n        }\n        ']);return k=function(){return e},e}function P(){var e=Object(N.a)(['\n        {\n          allProvincialBallots(\n            event_Description:"','"\n          ){\n            edges{\n              node{\n                partyResults {\n                  edges{\n                    node{\n                      validVotes\n                      percOfVotes\n                      party {\n                        id\n                        name\n                        abbreviation\n                      }\n                    }\n                  }\n                }\n                location {\n                  id\n                  name\n                }\n              }\n            }\n          }\n        }\n        ']);return P=function(){return e},e}function x(){var e=Object(N.a)(['\n        {\n          allVotingDistrictBallots(\n          event_Description:"','",\n          location_Id:"','", \n          location_Ward_Municipality_Name_Icontains:"','") {\n            edges{\n              node{\n                location {\n                  vdNumber\n                }\n                partyResults {\n                  edges{\n                    node{\n                      party{\n                        name\n                      }\n                      percOfVotes\n                    }\n                  }  \n                }\n              }\n            }\n          }\n        }\n        ']);return x=function(){return e},e}function S(){var e=Object(N.a)(['\n        {\n          allMunicipalBallots(\n            event_Description:"','",\n            location_Province_Name:"','", \n            location_Code: "','"\n          ) {\n            edges{\n              node {\n                partyResults {\n                  edges{\n                    node{\n                      party {               \n                        name\n                        abbreviation\n                      }\n                      validVotes\n                      percOfVotes\n                    }\n                  }\n                  \n                }\n                location {\n                  code\n                  name\n                  longName\n                }\n              }\n            }\n          }\n        }\n        ']);return S=function(){return e},e}function V(){var e=Object(N.a)(['\n        {\n          allProvincialBallots(\n            event_Description:"','",\n            location_Name_Icontains:"','"\n          ){\n            edges{\n              node{\n                partyResults {\n                  edges{\n                    node{\n                      validVotes\n                      percOfVotes\n                      party {\n                        id\n                        name\n                        abbreviation\n                      }\n                    }\n                  }\n                }\n                location {\n                  id\n                  name\n                }\n              }\n            }\n          }\n        }\n        ']);return V=function(){return e},e}function D(){var e=Object(N.a)(['\n        {\n          allBallots(\n            event_Description:"','"\n          ){\n            edges{\n              node{\n                partyResults {\n                  edges{\n                    node{\n                      validVotes\n                      percOfVotes\n                      party {\n                        id\n                        name\n                        abbreviation\n                      }\n                    }\n                  }\n                  \n                }\n                location {\n                  id\n                  name\n                }\n              }\n            }\n          }\n        }\n        ']);return D=function(){return e},e}var I=new E.a({link:new C.a({uri:"https://elections2019.xyz/graphql",useGETForQueries:!0,headers:{"Content-Type":"application/graphql"}}),cache:new w.a});function R(){var e=Object(N.a)(["\n    {\n      allParties {\n        edges{\n          node{\n            name\n            colour\n          }\n        }\n      }\n    }\n    "]);return R=function(){return e},e}function _(){var e=Object(N.a)(["\n    {\n      allEvents {\n        description\n      }\n    }\n    "]);return _=function(){return e},e}var B=new E.a({link:new C.a({uri:"https://elections2019.xyz/graphql",useGETForQueries:!0,headers:{"Content-Type":"application/graphql"}}),cache:new w.a});function M(){return B.query({query:j()(R())})}function L(e){function t(e){return-1!=e.indexOf("-")&&(e=e.split("-")[1]),-1!=e.indexOf("[")&&(e=e.split("[")[0]),e}return"national"==e.regionType?"South Africa":"province"==e.regionType?e.provinceName:"municipality"==e.regionType?t(e.muniName):"municipality-vd"==e.regionType?t(e.muniName)+"-"+e.vdNumber:void 0}var A,q;function W(e){return y.a[e]||e}var z=0,F=function(e){function t(e){var n;Object(l.a)(this,t),n=Object(s.a)(this,Object(u.a)(t).call(this,e));Object(m.a)(Object(m.a)(n));if(n.state={numParties:5,eventDescription:"2014 National Election",regionType:"national",provinceName:"",muniName:"",muniCode:"",vdNumber:""},e.numParties&&(n.state.numParties=e.numParties),e.regionType&&(n.state.regionType=e.regionType),e.provinceName&&(n.state.provinceName=e.provinceName),e.muniName&&(n.state.muniName=e.muniName),e.muniCode&&(n.state.muniCode=e.muniCode),e.vdNumber&&(n.state.vdNumber=e.vdNumber),e.width&&e.height)n.state.width=e.width,n.state.height=e.height;else{var a=n.getWidthHeightByScreenSize(),i=a.modifW,r=a.modifH;n.state.width=i,n.state.height=r}return n.handleRegionChange=n.handleRegionChange.bind(Object(m.a)(Object(m.a)(n))),n.handlePreviewEvent=n.handlePreviewEvent.bind(Object(m.a)(Object(m.a)(n))),n.redrawChart=n.redrawChart.bind(Object(m.a)(Object(m.a)(n))),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.draw(this.getContainer(),this.state),z=setInterval(function(){e.draw(e.getContainer(),e.state)},3e4),document.addEventListener(h,this.handleRegionChange),document.addEventListener(f,this.handlePreviewEvent),window.addEventListener("resize",this.redrawChart,200)}},{key:"componentDidUpdate",value:function(){this.draw(this.getContainer(),this.state)}},{key:"componentWillUnmount",value:function(){console.log("barchart unmount"),A=null,document.removeEventListener(h,this.handleRegionChange),document.removeEventListener(f,this.handlePreviewEvent),window.removeEventListener("resize",this.redrawChart),clearInterval(z)}},{key:"getWidthHeightByScreenSize",value:function(){var e=Math.min(810,document.body.clientWidth-350);return document.body.clientWidth<775&&(e=document.body.clientWidth-50),{modifW:e,modifH:e/3.5}}},{key:"redrawChart",value:function(){var e=this.getWidthHeightByScreenSize(),t=e.modifW,n=e.modifH;A&&A.destroy(),A=new g(this.getContainer(),t,n,W),this.setState({width:t,height:n})}},{key:"handleRegionChange",value:function(e){var t=e.detail;this.setState(t)}},{key:"handlePreviewEvent",value:function(e){var t=e.detail;A&&A.destroy(),A=new g(this.getContainer(),this.state.width,this.state.height,W),this.setState(t)}},{key:"getContainer",value:function(){return d.j(this.refs.vizcontainer)}},{key:"render",value:function(){return i.a.createElement("div",{className:"barchart"},i.a.createElement("div",{className:W("chart-title")},"RACE FOR VOTES (",L(this.state),"): "),i.a.createElement("div",{ref:"vizcontainer",className:W("chart-body"),style:{width:this.state.width,height:this.state.height}}))}},{key:"draw",value:function(e,t){console.log("drawing ...barchart");var n=this,a=[function(e){var t=e.eventDescription;if(t){if("national"==e.regionType)return I.query({query:j()(D(),t)});if("province"==e.regionType)return I.query({query:j()(V(),t,e.provinceName)});if("municipality"==e.regionType){var n=e.muniName.split(" - ")[0];return I.query({query:j()(S(),t,e.provinceName,n)})}return"municipality-vd"==e.regionType?I.query({query:j()(x(),t,e.vdNumber,e.muniCode)}):void 0}}(t)];if(!q){var i=M();a.push(i)}Promise.all(a).then(function(a){var i=a[0];q=q||a[1],n.drawGraph(e,t,i,q)}).catch(function(e){return console.error(e)})}},{key:"drawGraph",value:function(e,t,n,a){var i=function(e,t){var n,a=t.regionType;if(!(n="national"==a?e.data.allBallots.edges[0]:"province"==a?e.data.allProvincialBallots.edges[0]:"municipality"==a?e.data.allMunicipalBallots.edges[0]:e.data.allVotingDistrictBallots.edges[0]))return console.error("party data is empty!!"),null;var i=n.node;return(i.partyResults||i.topResult).edges.slice(0,t.numParties).map(function(e){var t=e.node;return{name:t.party.abbreviation,validVotes:t.validVotes,percOfVotes:t.percOfVotes,partyInfo:t.party}})}(n,t),r=parseInt(t.width),o=parseInt(t.height);A||(A=new g(e,r,o,W)),console.log("chart component",A),A.draw(i,a)}}]),t}(a.Component),U={DOMAIN:"https://sabc-eds.github.io/elections-dataviz"},G=n(21),H=n.n(G),Y=n(49),K=n.n(Y);function Q(e){return H.a[e]||K.a[e]||e}var J,X=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={elementId:"root",eventDescription:"2014 National Election",regionType:"province",provinceName:"Western Cape",muniName:"",muniCode:"",vdNumber:"",numParties:5,electionEvents:[]},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;B.query({query:j()(_())}).then(function(t){var n=t.data.allEvents.map(function(e){return e.description});e.setState({electionEvents:n})}).catch(function(e){return console.error(e)})}},{key:"componentDidUpdate",value:function(){}},{key:"onEventDescriptionChange",value:function(e){this.setState({eventDescription:e.target.value})}},{key:"onRegionTypeChange",value:function(e){var t={regionType:e.target.value};this.setState(t)}},{key:"onPreview",value:function(e){var t=new CustomEvent(f,{detail:this.state});document.dispatchEvent(t)}},{key:"render",value:function(){var e=this,t=U.DOMAIN,n=this.state,a=n.elementId,r=n.eventDescription,o=n.regionType,l=n.provinceName,c=n.muniName,s=n.muniCode,u=n.vdNumber,p=n.numParties,m=n.electionEvents;return i.a.createElement("div",null,i.a.createElement("h3",null," Barchart Embed Script Generation "),i.a.createElement("div",{className:Q("form-group")},i.a.createElement("label",null,"Element ID "),i.a.createElement("input",{type:"text",className:Q("form-control"),placeholder:"chart-container",onChange:function(t){return e.setState({elementId:t.target.value})}})),i.a.createElement("div",{className:Q("form-group")},i.a.createElement("label",null,"Event "),i.a.createElement("select",{className:Q("form-control"),value:r,onChange:this.onEventDescriptionChange.bind(this)},m.map(function(e){return i.a.createElement("option",{key:e,value:e},e)}))),i.a.createElement("div",{className:Q("form-group")},i.a.createElement("label",null,"Region Type "),i.a.createElement("select",{className:Q("form-control"),value:o,onChange:this.onRegionTypeChange.bind(this)},i.a.createElement("option",{value:"national"},"national"),i.a.createElement("option",{value:"province"},"province"),i.a.createElement("option",{value:"municipality"},"municipality"),i.a.createElement("option",{value:"municipality-vd"},"voting district"))),"national"!=o&&i.a.createElement("div",{className:Q("form-group")},i.a.createElement("label",null,"Province Name"),i.a.createElement("input",{type:"text",className:Q("form-control"),placeholder:"Western Cape",value:l,onChange:function(t){return e.setState({provinceName:t.target.value})},disabled:"national"==o})),"municipality"==o&&i.a.createElement("div",{className:Q("form-group")},i.a.createElement("label",null,"Municipality Name"),i.a.createElement("input",{type:"text",className:Q("form-control"),placeholder:"City of Cape Town",value:c,onChange:function(t){return e.setState({muniName:t.target.value})},disabled:"national"==o})),"municipality-vd"==o&&i.a.createElement("div",{className:Q("form-group")},i.a.createElement("label",null,"Municipality Code"),i.a.createElement("input",{type:"text",className:Q("form-control"),placeholder:"CPT",value:s,onChange:function(t){return e.setState({muniCode:t.target.value})},disabled:"national"==o})),"municipality-vd"==o&&i.a.createElement("div",{className:Q("form-group")},i.a.createElement("label",null,"Voting District Number"),i.a.createElement("input",{type:"text",className:Q("form-control"),placeholder:"97860055",value:u,onChange:function(t){return e.setState({vdNumber:t.target.value})},disabled:"national"==o})),i.a.createElement("div",{className:Q("form-group")},i.a.createElement("label",null,"Number Of Parties"),i.a.createElement("input",{type:"number",className:Q("form-control"),placeholder:"5",value:p,onChange:function(t){return e.setState({numParties:t.target.value})}})),i.a.createElement("div",{className:Q("form-group")},i.a.createElement("button",{type:"button",onClick:this.onPreview.bind(this),className:Q("btn")+" "+Q("btn-primary")},"Preview")),i.a.createElement("div",{className:Q("form-group")},i.a.createElement("label",null,"Embed Code"),i.a.createElement("div",{className:Q("embedcode")},i.a.createElement("span",null,'<script src="'.concat(t,'/embed/embed.js"><\/script>\n                    <script>showBarChart(\n                        document.getElementById("').concat(a,'"),\n                        {\n                            eventDescription: "').concat(r,'",\n                            regionType: "').concat(o,'",\n                            provinceName: "').concat(l,'",\n                            muniName: "').concat(c,'",\n                            muniCode: "').concat(s,'",\n                            vdNumber: "').concat(u,'",\n                            numParties: "').concat(p,'",\n                            width: 600,\n                            height: 220\n                        });<\/script>').replace(/(\r\n|\n|\r)/gm,"")))))}}]),t}(a.Component),Z=n(55),$=(n(79),n(28)),ee=n.n($),te=n(52),ne=n.n(te),ae=n(53),ie=n.n(ae),re="#9c9c9c";function oe(e){return ne.a[e]||e}var le=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={disableNavigation:!1,eventDescription:"2014 National Election",regionType:"national",provinceName:"",muniName:"",muniCode:"",vdNumber:""},e.regionType&&(n.state.regionType=e.regionType),e.provinceName&&(n.state.provinceName=e.provinceName),e.muniName&&(n.state.muniName=e.muniName),e.disableNavigation&&(n.state.disableNavigation=e.disableNavigation),n.handlePreviewEvent=n.handlePreviewEvent.bind(Object(m.a)(Object(m.a)(n))),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"draw",value:function(e,t){console.log("drawing ...map"),this.drawGraph(e,t)}},{key:"componentDidMount",value:function(){this.draw(this.getContainer(),this.state),document.addEventListener(b,this.handlePreviewEvent)}},{key:"componentWillUnmount",value:function(){document.removeEventListener(b,this.handlePreviewEvent)}},{key:"componentDidUpdate",value:function(){this.draw(this.getContainer(),this.state)}},{key:"handlePreviewEvent",value:function(e){var t=e.detail;this.setState(t)}},{key:"handleNavBarSelection",value:function(e,t){var n;if("national"==e){if(n={regionType:e},this.state.regionType==n.regionType)return}else if("province"==e){if(n={regionType:e,provinceName:t.name},this.state.regionType==n.regionType&&this.state.provinceName==n.provinceName)return}else if("municipality"==e&&(n={regionType:e,provinceName:t.provinceName,muniName:t.muniName,muniCode:t.muniCode},this.state.regionType==n.regionType&&this.state.provinceName==n.provinceName&&this.state.newState==n.muniName))return;var a=new CustomEvent(h,{detail:n});document.dispatchEvent(a),this.setState(n)}},{key:"getContainer",value:function(){return d.j(this.refs.vizcontainer)}},{key:"getLoadingSpinner",value:function(){return d.j(this.refs.loading)}},{key:"render",value:function(){this.state.disableNavigation;return i.a.createElement("div",{className:"map-container"},L(this.state),i.a.createElement("div",{className:"loading-spinner",ref:"loading"},i.a.createElement(ie.a,{type:"spin",color:"#777",height:100,width:100})),i.a.createElement("div",{ref:"vizcontainer",style:{display:"hidden"},className:"map"}))}},{key:"drawGraph",value:function(e,t){var n=this,a="province_lo-res.geojson";var i,r=U.DOMAIN+"/mapdata/"+function(){switch(n.state.regionType){case"national":return a;case"province":return{Limpopo:"lim_lo-res.geojson",Mpumalanga:"mp_lo-res.geojson",Gauteng:"gt_lo-res.geojson","KwaZulu-Natal":"kzn_lo-res.geojson","North West":"nw_lo-res.geojson","Free State":"fs_lo-res.geojson","Eastern Cape":"ec_lo-res.geojson","Northern Cape":"nc_lo-res.geojson","Western Cape":"wc_lo-res.geojson"}[n.state.provinceName];case"municipality":return n.state.muniCode+".topojson";default:return null}}();n.getLoadingSpinner().style("display","block").transition().duration(200).style("opacity",1),i=document.getElementsByClassName("tooltip")[0]?d.j(".tooltip"):d.j("body").append("div").attr("class",oe("tooltip")).style("opacity",0),console.log("process.env",Object({NODE_ENV:"production",PUBLIC_URL:"."}));e.selectAll("svg").remove();var o=e.append("svg").attr("preserveAspectRatio","xMinYMin meet").style("background-color","#ffffff").attr("viewBox","0 0 900 800").classed("svg-content",!0),l=[d.f(r),function(e){var t=e.eventDescription;if(t){if("national"==e.regionType)return I.query({query:j()(P(),t)});if("province"==e.regionType)return I.query({query:j()(k(),t,e.provinceName)});if("municipality"==e.regionType){var n=e.muniName.split(" - ")[1];return I.query({query:j()(O(),t,n)})}}}(t)];if(!J){var c=M();l.push(c)}Promise.all(l).then(function(e){var a=e[0],l=function(e,t){if(!e)return null;var n={},a=t.regionType;return console.log("parseMainPartyData",e,a),"national"===a?e.data.allProvincialBallots.edges.forEach(function(e){var t=e.node,a=t.location.name,i=(t.partyResults||t.topResult).edges[0].node.party.name;n[a]=i}):"province"===a?e.data.allMunicipalBallots.edges.forEach(function(e){var t=e.node,a=t.location.code,i=(t.partyResults||t.topResult).edges[0].node.party.name;n[a]=i}):e.data.allVotingDistrictBallots.edges.forEach(function(e){var t=e.node,a=t.location.vdNumber,i=(t.partyResults||t.topResult).edges[0].node.party.name;n[a]=i}),n}(e[1],t);J=J||e[2];var c,s={};J&&J.data.allParties.edges&&J.data.allParties.edges.forEach(function(e){s[e.node.name]=e.node.colour}),-1!==r.indexOf(".topojson")&&(a=Z.a(a,a.objects[n.state.muniCode])),c=a.features;var u=d.d().fitSize([900,800],a),p=d.e().projection(u);if(o.selectAll(".".concat(oe("region"))).data(c).enter().append("path").attr("class",oe("region")).attr("stroke","#eeeeee").attr("fill",function(e,t){var a,i,r=n.state.regionType;if("national"===r){var o=e.properties.SPROVINCE;a=l[o],console.log("mainParty",a,o),console.log("partyColor",p)}else if("province"===r){var c=(i=e.properties).code||i.smunicipal.split("-")[0].replace(/\s/g,"");a=l[c]}else{var u=function(e){return e.PKLVDNUMBE}(e.properties);a=l[u]}var p=function(e){return e&&s[e.split("/")[0]]||re}(a);return p}).attr("id",function(e,t){return"region-".concat(t)}).attr("d",p),"municipality"!==n.state.regionType&&o.selectAll(".place-label").data(c).enter().append("text").attr("class","place-label").attr("font-size","12px").attr("transform",function(e){var t,n;return"Polygon"===e.geometry.type?(t=ee()(e.geometry.coordinates),(n=u(t))[1]-=12,"translate("+n+")"):(t=ee()(e.geometry.coordinates[0]),(n=u(t))[1]-=5,"translate("+n+")")}).attr("dy",".35em").style("text-anchor","middle").text(function(e){return"national"===n.state.regionType?e.properties.SPROVINCE:"province"===n.state.regionType?e.properties.smunicipal.split("-")[1].split("[")[0]:e.properties.SMUNICIPAL.split("-")[1].split("[")[0]}),"municipality"!==n.state.regionType){var m,v=document.getElementsByClassName("place-label"),y={},g={};for(m=0;m<c.length;m++)y[m]=v[m].getBoundingClientRect();for(m=0;m<c.length;m++){for(var f=0;f<m;f++){var b=y[m],N=y[f];!(b.right<N.left||b.left>N.right||b.bottom<N.top||b.top>N.bottom)&&(g[m]=g[m]?g[m]+1:1)}g[m]>2?v[m].setAttribute("opacity",0):g[m]>0&&(v[m].innerHTML=v[m].innerHTML.slice(0,3)+"...")}}(o.selectAll(".eventLayer").data(c).enter().append("path").attr("d",p).attr("class","eventLayer").attr("id",function(e,t){return"eventLayer-".concat(t)}).attr("fill","transparent").on("mouseover",function(e,t){d.j("#region-".concat(t)).attr("stroke-width",3).style("fill-opacity",.8)}).on("mousemove",function(e){"municipality"!==n.state.regionType&&(i.transition().duration(200).style("opacity",1),i.html("national"===n.state.regionType?e.properties.SPROVINCE:"province"===n.state.regionType?e.properties.smunicipal.split("-")[1].split("[")[0]:e.properties.SMUNICIPAL.split("-")[1].split("[")[0]).style("left",d.c.pageX+"px").style("top",d.c.pageY-28+"px"))}).on("mouseout",function(e,t){d.j("#region-".concat(t)).attr("stroke-width",1).style("fill-opacity",1),"municipality"!==n.state.regionType&&i.transition().duration(200).style("opacity",0)}).on("click",function(e,t){if(!n.state.disableNavigation){i.transition().duration(200).style("opacity",0);var a,r=n.state.regionType;if("national"===r)o={regionType:"province",provinceName:e.properties.SPROVINCE},l=new CustomEvent(h,{detail:o}),document.dispatchEvent(l),n.setState(o);else if("province"===r){o={regionType:"municipality",provinceName:n.state.provinceName,muniName:e.properties.smunicipal,muniCode:(a=e.properties,a.code||a.smunicipal.split("-")[0].replace(/\s/g,""))},l=new CustomEvent(h,{detail:o}),document.dispatchEvent(l),n.setState(o)}else{var o={regionType:"municipality-vd",provinceName:n.state.provinceName,muniName:n.state.muniName,muniCode:n.state.muniCode,vdNumber:function(e){return e.PKLVDNUMBE}(e.properties)},l=new CustomEvent(h,{detail:o});document.dispatchEvent(l)}}}),n.state.disableNavigation)||o.append("foreignObject").attr("x",800).attr("y",10).attr("width",100).attr("height",30).attr("class","map-controls").append("xhtml:div").append("button").attr("class","go-back").html("go back").on("click",function(){var e,t=n.state.regionType,a={regionType:n.state.regionType,provinceName:n.state.provinceName,muniName:n.state.muniName,muniImuniCodeD:n.state.muniCode,vdNumber:n.state.vdNumber};"province"===t?a.regionType="national":"municipality"===t&&(a.regionType="province"),e=new CustomEvent(h,{detail:a}),document.dispatchEvent(e),n.setState(a)});n.getLoadingSpinner().style("display","none")});window.addEventListener("resize",function(){},200)}}]),t}(a.Component),ce=n(54),se=n.n(ce);function ue(e){return H.a[e]||se.a[e]||e}var pe=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={elementId:"root",disableNavigation:!1,regionType:"province",provinceName:"Western Cape",muniName:""},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){}},{key:"onRegionTypeChange",value:function(e){var t={regionType:e.target.value};this.setState(t)}},{key:"onPreview",value:function(e){var t=new CustomEvent(b,{detail:this.state});document.dispatchEvent(t)}},{key:"render",value:function(){var e=this,t=U.DOMAIN,n=this.state,a=n.elementId,r=n.disableNavigation,o=n.regionType,l=n.provinceName,c=n.muniName;return i.a.createElement("div",null,i.a.createElement("h3",null," Map Embed Script Generation "),i.a.createElement("div",{className:ue("form-group")},i.a.createElement("label",null,"Element ID "),i.a.createElement("input",{type:"text",className:ue("form-control"),placeholder:"chart-container",onChange:function(t){return e.setState({elementId:t.target.value})}})),i.a.createElement("div",{className:ue("form-group")},i.a.createElement("label",null,"Region Type "),i.a.createElement("select",{className:ue("form-control"),value:o,onChange:this.onRegionTypeChange.bind(this)},i.a.createElement("option",{value:"national"},"national"),i.a.createElement("option",{value:"province"},"province"),i.a.createElement("option",{value:"municipality"},"municipality"))),"national"!=o&&i.a.createElement("div",{className:ue("form-group")},i.a.createElement("label",null,"Province Name"),i.a.createElement("input",{type:"text",className:ue("form-control"),placeholder:"Western Cape",value:l,onChange:function(t){return e.setState({provinceName:t.target.value})}})),"municipality"==o&&i.a.createElement("div",{className:ue("form-group")},i.a.createElement("label",null,"Municipality Name"),i.a.createElement("input",{type:"text",className:ue("form-control"),placeholder:"City of Cape Town",value:c,onChange:function(t){return e.setState({muniName:t.target.value})}})),i.a.createElement("div",{className:ue("form-check")},i.a.createElement("label",{className:ue("form-check-label")},i.a.createElement("input",{type:"checkbox",className:ue("form-check-input"),value:r,onChange:function(t){return e.setState({disableNavigation:t.target.checked})}}),"\xa0\xa0Disable Navigation")),i.a.createElement("div",{className:ue("form-group")},i.a.createElement("button",{type:"button",onClick:this.onPreview.bind(this),className:ue("btn")+" "+ue("btn-primary")},"Preview")),i.a.createElement("div",{className:ue("form-group")},i.a.createElement("label",null,"Embed Code"),i.a.createElement("div",{className:ue("embedcode")},i.a.createElement("span",null,'<script src="'.concat(t,'/embed/embed.js"><\/script>\n                    <script>\n                        showMap(document.getElementById("').concat(a,'"),{\n                            disableNavigation: ').concat(r,',\n                            regionType: "').concat(o,'",\n                            provinceName: "').concat(l,'",\n                            muniName: "').concat(c,'",\n                        });<\/script>').replace(/(\r\n|\n|\r)/gm,"")))))}}]),t}(a.Component),me=(n(92),a.Component,function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement("div",{className:"leftContainer"},i.a.createElement(F,{regionName:"South Africa",regionType:"national",numParties:3}),i.a.createElement(le,{regionType:"province",provinceName:"Western Cape"})),i.a.createElement("div",{className:"rightContainer"},i.a.createElement("div",{className:"barchartEmbed"},i.a.createElement(X,null)),i.a.createElement("div",{className:"mapEmbed"},i.a.createElement(pe,null))),i.a.createElement("div",{id:"sales-data"}))}}]),t}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(me,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[58,2,1]]]);
//# sourceMappingURL=main.580b495a.chunk.js.map