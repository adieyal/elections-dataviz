(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{40:function(e,t,n){},46:function(e,t,n){},49:function(e,t,n){},51:function(e,t,n){},56:function(e,t,n){e.exports=n(92)},61:function(e,t,n){},63:function(e,t,n){},90:function(e,t,n){},92:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(18),o=n.n(r),l=(n(61),n(5)),c=n(6),s=n(8),u=n(7),p=n(9),m=(n(63),n(3)),d=n(2),v=n(40),g=n.n(v);function h(e,t,n,a){var i,r=["blue","yellow","red"],o=e.append("svg").attr("width",parseInt(t)+70).attr("height",parseInt(n)+20);i=document.getElementsByClassName("tooltip")[0]?d.i(".tooltip"):d.i("body").append("div").attr("class",a("tooltip")).style("opacity",0);var l=d.g().rangeRound([70,t]),c=d.h().rangeRound([n,20]);o.append("g").attr("transform","translate(20,"+(n/2+10)+")").append("text").attr("class",a("percentage-label")).attr("transform","rotate(-90)").text("PERCENTAGE VOTES").attr("text-anchor","middle"),o.append("g").attr("class","x axis").attr("transform","translate(0,"+n+")"),o.append("g").attr("class","y axis").attr("transform","translate(70, 0)");var s=o.append("g").attr("class",a("bar-container")),u=o.append("g").attr("class",a("bartext-container"));this.draw=function(e,t){var p={};function m(e,t){return p[e.split("/")[0]]||r[t%r.length]}t&&t.data.allParties.edges&&t.data.allParties.edges.forEach(function(e){p[e.node.name]=e.node.colour}),l.domain(e.map(function(e){return e.name})),c.domain([0,100]),o.select(".x.axis").transition().duration(300).call(d.a(l)),o.select(".y.axis").transition().duration(300).call(d.b(c).ticks(6).tickFormat(function(e){return e+"%"}));var v=s.selectAll(".".concat(a("bar"))).data(e);v.exit().transition().duration(300).attr("y",function(e){return c(0)}).attr("height",0).style("fill-opacity",1e-6).remove(),v.enter().append("rect").attr("class",a("bar")).attr("x",function(e){return l(e.name)+l.bandwidth()/20}).attr("width",9*l.bandwidth()/10).attr("fill",function(e,t){return m(e.partyInfo.name,t)}).on("mousemove",function(e){var t;d.i(this).attr("opacity",.8),i.transition().duration(200).style("opacity",.9),i.html((t=e.partyInfo.name,t.split("/")[0].toLowerCase().replace(/\b\w/g,function(e){return e.toUpperCase()})+" : "+e.percOfVotes+"%")).style("left",d.c.pageX+"px").style("top",d.c.pageY-28+"px")}).on("mouseout",function(e){d.i(this).attr("opacity",1),i.transition().duration(200).style("opacity",0)}).attr("y",function(e){return c(0)}).attr("height",0),s.selectAll(".".concat(a("bar"))).data(e).attr("fill",function(e,t){return m(e.partyInfo.name,t)}).transition().duration(300).attr("y",function(e){return c(Number(e.percOfVotes))}).attr("height",function(e){return n-c(Number(e.percOfVotes))});var g=u.selectAll(".".concat(a("bartext"))).data(e);g.exit().transition().duration(300).attr("y",function(e){return c(0)-5}).style("fill-opacity",1e-6).remove(),g.enter().append("text").attr("class",a("bartext")).attr("x",function(e){return l(e.name)+l.bandwidth()/2}).attr("text-anchor","middle").attr("font-size","12px").attr("y",function(e){return c(0)-5}),u.selectAll(".".concat(a("bartext"))).data(e).text(function(e){return e.percOfVotes+"%"}).transition().duration(300).attr("y",function(e){return c(Number(e.percOfVotes))-5})},this.destroy=function(){o.remove()}}var y="region-change",f="barchart-preview",b="map-preview",N=n(13),E=n(99),C=n(53),w=n(100),T=n(14),O=n.n(T);function j(){var e=Object(N.a)(['\n        {\n          allVotingDistrictBallots( \n          event_Description:"','",\n          location_Ward_Municipality_Name_Icontains:"','") {\n            edges{\n              node{\n                location {\n                  vdNumber\n                }\n                partyResults {\n                  edges{\n                    node{\n                      party{\n                        name\n                        abbreviation\n                      }\n                    }\n                  }  \n                }\n              }\n            }\n          }\n        }\n        ']);return j=function(){return e},e}function k(){var e=Object(N.a)(['\n      {\n        allMunicipalBallots(\n          event_Description:"','",\n          location_Province_Name:"','"\n        ) {\n          edges{\n            node {\n              partyResults {\n                edges{\n                  node{\n                    party {               \n                      name\n                      abbreviation\n                    }\n                    validVotes\n                    percOfVotes\n                  }\n                }\n                \n              }\n              location {\n                code\n                name\n                longName\n              }\n            }\n          }\n        }\n      }\n      ']);return k=function(){return e},e}function P(){var e=Object(N.a)(['\n      {\n        allProvincialBallots(\n          event_Description:"','"\n        ){\n          edges{\n            node{\n              partyResults {\n                edges{\n                  node{\n                    validVotes\n                    percOfVotes\n                    party {\n                      id\n                      name\n                      abbreviation\n                    }\n                  }\n                }\n              }\n              location {\n                id\n                name\n              }\n            }\n          }\n        }\n      }\n      ']);return P=function(){return e},e}function S(){var e=Object(N.a)(['\n      {\n        allVotingDistrictBallots(\n        event_Description:"','",\n        location_Id:"','", \n        location_Ward_Municipality_Name_Icontains:"','") {\n          edges{\n            node{\n              location {\n                vdNumber\n              }\n              partyResults {\n                edges{\n                  node{\n                    party{\n                      name\n                    }\n                    percOfVotes\n                  }\n                }  \n              }\n            }\n          }\n        }\n      }\n      ']);return S=function(){return e},e}function x(){var e=Object(N.a)(['\n      {\n        allMunicipalBallots(\n          event_Description:"','",\n          location_Province_Name:"','", \n          location_Code: "','"\n        ) {\n          edges{\n            node {\n              partyResults {\n                edges{\n                  node{\n                    party {               \n                      name\n                      abbreviation\n                    }\n                    validVotes\n                    percOfVotes\n                  }\n                }\n                \n              }\n              location {\n                code\n                name\n                longName\n              }\n            }\n          }\n        }\n      }\n      ']);return x=function(){return e},e}function D(){var e=Object(N.a)(['\n      {\n        allProvincialBallots(\n          event_Description:"','",\n          location_Name_Icontains:"','"\n        ){\n          edges{\n            node{\n              partyResults {\n                edges{\n                  node{\n                    validVotes\n                    percOfVotes\n                    party {\n                      id\n                      name\n                      abbreviation\n                    }\n                  }\n                }\n              }\n              location {\n                id\n                name\n              }\n            }\n          }\n        }\n      }\n      ']);return D=function(){return e},e}function R(){var e=Object(N.a)(['\n      {\n        allBallots(\n          event_Description:"','"\n        ){\n          edges{\n            node{\n              partyResults {\n                edges{\n                  node{\n                    validVotes\n                    percOfVotes\n                    party {\n                      id\n                      name\n                      abbreviation\n                    }\n                  }\n                }\n                \n              }\n              location {\n                id\n                name\n              }\n            }\n          }\n        }\n      }\n      ']);return R=function(){return e},e}function I(){var e=Object(N.a)(["\n    {\n      allParties {\n        edges{\n          node{\n            name\n            colour\n          }\n        }\n      }\n    }\n    "]);return I=function(){return e},e}function _(){var e=Object(N.a)(["\n    {\n      allEvents {\n        description\n      }\n    }\n    "]);return _=function(){return e},e}var V=new E.a({link:new C.a({uri:"https://elections2019.xyz/graphql",useGETForQueries:!0,headers:{"Content-Type":"application/graphql"}}),cache:new w.a});function B(){return V.query({query:O()(I())})}var M,L;function A(e){return g.a[e]||e}var W=0,q=function(e){function t(e){var n;Object(l.a)(this,t),n=Object(s.a)(this,Object(u.a)(t).call(this,e));Object(m.a)(Object(m.a)(n));if(n.state={numParties:5,eventDescription:"2014 National Election",regionType:"national",provinceName:"",muniName:"",muniCode:"",vdNumber:""},e.numParties&&(n.state.numParties=e.numParties),e.regionType&&(n.state.regionType=e.regionType),e.provinceName&&(n.state.provinceName=e.provinceName),e.muniName&&(n.state.muniName=e.muniName),e.muniCode&&(n.state.muniCode=e.muniCode),e.vdNumber&&(n.state.vdNumber=e.vdNumber),e.width&&e.height)n.state.width=e.width,n.state.height=e.height;else{var a=n.getWidthHeightByScreenSize(),i=a.modifW,r=a.modifH;n.state.width=i,n.state.height=r}return n.handleRegionChange=n.handleRegionChange.bind(Object(m.a)(Object(m.a)(n))),n.handlePreviewEvent=n.handlePreviewEvent.bind(Object(m.a)(Object(m.a)(n))),n.redrawChart=n.redrawChart.bind(Object(m.a)(Object(m.a)(n))),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.draw(this.getContainer(),this.state),W=setInterval(function(){e.draw(e.getContainer(),e.state)},3e4),document.addEventListener(y,this.handleRegionChange),document.addEventListener(f,this.handlePreviewEvent),window.addEventListener("resize",this.redrawChart,200)}},{key:"componentDidUpdate",value:function(){this.draw(this.getContainer(),this.state)}},{key:"componentWillUnmount",value:function(){console.log("barchart unmount"),M=null,document.removeEventListener(y,this.handleRegionChange),document.removeEventListener(f,this.handlePreviewEvent),window.removeEventListener("resize",this.redrawChart),clearInterval(W)}},{key:"getWidthHeightByScreenSize",value:function(){var e=Math.min(810,document.body.clientWidth-350);return document.body.clientWidth<775&&(e=document.body.clientWidth-50),{modifW:e,modifH:e/3.5}}},{key:"redrawChart",value:function(){var e=this.getWidthHeightByScreenSize(),t=e.modifW,n=e.modifH;M&&M.destroy(),M=new h(this.getContainer(),t,n,A),this.setState({width:t,height:n})}},{key:"handleRegionChange",value:function(e){var t=e.detail;this.setState(t)}},{key:"handlePreviewEvent",value:function(e){var t=e.detail;M&&M.destroy(),M=new h(this.getContainer(),this.state.width,this.state.height,A),this.setState(t)}},{key:"getContainer",value:function(){return d.i(this.refs.vizcontainer)}},{key:"getRegionName",value:function(){return"national"==this.state.regionType?"South Africa":"province"==this.state.regionType?this.state.provinceName:"municipality"==this.state.regionType?this.state.muniName:"municipality-vd"==this.state.regionType?this.state.muniName+"-"+this.state.vdNumber:void 0}},{key:"render",value:function(){return i.a.createElement("div",{className:"barchart"},i.a.createElement("div",{className:A("chart-title")},"RACE FOR VOTES (",this.getRegionName(),"): "),i.a.createElement("div",{ref:"vizcontainer",className:A("chart-body"),style:{width:this.state.width,height:this.state.height}}))}},{key:"draw",value:function(e,t){console.log("drawing ...barchart");var n=this,a=[function(e){var t=e.eventDescription;if(t){if("national"==e.regionType)return V.query({query:O()(R(),t)});if("province"==e.regionType)return V.query({query:O()(D(),t,e.provinceName)});if("municipality"==e.regionType){var n=e.muniName.split(" - ")[0];return V.query({query:O()(x(),t,e.provinceName,n)})}return"municipality-vd"==e.regionType?V.query({query:O()(S(),t,e.vdNumber,e.muniCode)}):void 0}}(t)];if(!L){var i=B();a.push(i)}Promise.all(a).then(function(a){var i=a[0];L=L||a[1],n.drawGraph(e,t,i,L)}).catch(function(e){return console.error(e)})}},{key:"drawGraph",value:function(e,t,n,a){var i=function(e,t){var n,a=t.regionType;if(!(n="national"==a?e.data.allBallots.edges[0]:"province"==a?e.data.allProvincialBallots.edges[0]:"municipality"==a?e.data.allMunicipalBallots.edges[0]:e.data.allVotingDistrictBallots.edges[0]))return console.error("party data is empty!!"),null;var i=n.node;return(i.partyResults||i.topResult).edges.slice(0,t.numParties).map(function(e){var t=e.node;return{name:t.party.abbreviation,validVotes:t.validVotes,percOfVotes:t.percOfVotes,partyInfo:t.party}})}(n,t),r=parseInt(t.width),o=parseInt(t.height);M||(M=new h(e,r,o,A)),console.log("chart component",M),M.draw(i,a)}}]),t}(a.Component),z={DOMAIN:"https://sabc-eds.github.io/elections-dataviz"},U=n(21),G=n.n(U),H=n(46),F=n.n(H);function K(e){return G.a[e]||F.a[e]||e}var Y,J=function(e){function t(e){var n;Object(l.a)(this,t),n=Object(s.a)(this,Object(u.a)(t).call(this,e));var a=Object(m.a)(Object(m.a)(n));return n.state={elementId:"root",eventDescription:"2014 National Election",regionType:"province",provinceName:"Western Cape",muniName:"",muniCode:"",vdNumber:"",numParties:5,electionEvents:[]},V.query({query:O()(_())}).then(function(e){var t=e.data.allEvents.map(function(e){return e.description});a.setState({electionEvents:t})}).catch(function(e){return console.error(e)}),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){}},{key:"onEventDescriptionChange",value:function(e){this.setState({eventDescription:e.target.value})}},{key:"onRegionTypeChange",value:function(e){var t={regionType:e.target.value};this.setState(t)}},{key:"onPreview",value:function(e){var t=new CustomEvent(f,{detail:this.state});document.dispatchEvent(t)}},{key:"render",value:function(){var e=this,t=z.DOMAIN,n=this.state,a=n.elementId,r=n.eventDescription,o=n.regionType,l=n.provinceName,c=n.muniName,s=n.muniCode,u=n.vdNumber,p=n.numParties,m=n.electionEvents;return i.a.createElement("div",null,i.a.createElement("h3",null," Barchart Embed Script Generation "),i.a.createElement("div",{className:K("form-group")},i.a.createElement("label",null,"Element ID "),i.a.createElement("input",{type:"text",className:K("form-control"),placeholder:"chart-container",onChange:function(t){return e.setState({elementId:t.target.value})}})),i.a.createElement("div",{className:K("form-group")},i.a.createElement("label",null,"Event "),i.a.createElement("select",{className:K("form-control"),value:r,onChange:this.onEventDescriptionChange.bind(this)},m.map(function(e){return i.a.createElement("option",{key:e,value:e},e)}))),i.a.createElement("div",{className:K("form-group")},i.a.createElement("label",null,"Region Type "),i.a.createElement("select",{className:K("form-control"),value:o,onChange:this.onRegionTypeChange.bind(this)},i.a.createElement("option",{value:"national"},"national"),i.a.createElement("option",{value:"province"},"province"),i.a.createElement("option",{value:"municipality"},"municipality"),i.a.createElement("option",{value:"municipality-vd"},"voting district"))),"national"!=o&&i.a.createElement("div",{className:K("form-group")},i.a.createElement("label",null,"Province Name"),i.a.createElement("input",{type:"text",className:K("form-control"),placeholder:"Western Cape",value:l,onChange:function(t){return e.setState({provinceName:t.target.value})},disabled:"national"==o})),"municipality"==o&&i.a.createElement("div",{className:K("form-group")},i.a.createElement("label",null,"Municipality Name"),i.a.createElement("input",{type:"text",className:K("form-control"),placeholder:"City of Cape Town",value:c,onChange:function(t){return e.setState({muniName:t.target.value})},disabled:"national"==o})),"municipality-vd"==o&&i.a.createElement("div",{className:K("form-group")},i.a.createElement("label",null,"Municipality Code"),i.a.createElement("input",{type:"text",className:K("form-control"),placeholder:"CPT",value:s,onChange:function(t){return e.setState({muniCode:t.target.value})},disabled:"national"==o})),"municipality-vd"==o&&i.a.createElement("div",{className:K("form-group")},i.a.createElement("label",null,"Voting District Number"),i.a.createElement("input",{type:"text",className:K("form-control"),placeholder:"97860055",value:u,onChange:function(t){return e.setState({vdNumber:t.target.value})},disabled:"national"==o})),i.a.createElement("div",{className:K("form-group")},i.a.createElement("label",null,"Number Of Parties"),i.a.createElement("input",{type:"number",className:K("form-control"),placeholder:"5",value:p,onChange:function(t){return e.setState({numParties:t.target.value})}})),i.a.createElement("div",{className:K("form-group")},i.a.createElement("button",{type:"button",onClick:this.onPreview.bind(this),className:K("btn")+" "+K("btn-primary")},"Preview")),i.a.createElement("div",{className:K("form-group")},i.a.createElement("label",null,"Embed Code"),i.a.createElement("div",{className:K("embedcode")},i.a.createElement("span",null,'<script src="'.concat(t,'/embed/embed.js"><\/script>\n                    <script>showBarChart(\n                        document.getElementById("').concat(a,'"),\n                        {\n                            eventDescription: "').concat(r,'",\n                            regionType: "').concat(o,'",\n                            provinceName: "').concat(l,'",\n                            muniName: "').concat(c,'",\n                            muniCode: "').concat(s,'",\n                            vdNumber: "').concat(u,'",\n                            numParties: "').concat(p,'",\n                            width: 600,\n                            height: 220\n                        });<\/script>').replace(/(\r\n|\n|\r)/gm,"")))))}}]),t}(a.Component),X=n(52),Q=(n(77),n(28)),Z=n.n(Q),$=n(49),ee=n.n($),te=n(50),ne=n.n(te),ae="#9c9c9c";function ie(e){return ee.a[e]||e}var re=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={disableNavigation:!1,eventDescription:"2014 National Election",regionType:"national",provinceName:"",muniName:"",muniCode:"",vdNumber:""},e.regionType&&(n.state.regionType=e.regionType),e.provinceName&&(n.state.provinceName=e.provinceName),e.muniName&&(n.state.muniName=e.muniName),e.disableNavigation&&(n.state.disableNavigation=e.disableNavigation),n.handlePreviewEvent=n.handlePreviewEvent.bind(Object(m.a)(Object(m.a)(n))),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"draw",value:function(e,t){console.log("drawing ...map"),this.drawGraph(e,t)}},{key:"componentDidMount",value:function(){this.draw(this.getContainer(),this.state),document.addEventListener(b,this.handlePreviewEvent)}},{key:"componentWillUnmount",value:function(){document.removeEventListener(b,this.handlePreviewEvent)}},{key:"componentDidUpdate",value:function(){this.draw(this.getContainer(),this.state)}},{key:"handlePreviewEvent",value:function(e){var t=e.detail;this.setState(t)}},{key:"handleNavBarSelection",value:function(e,t){var n;if("national"==e){if(n={regionType:e},this.state.regionType==n.regionType)return}else if("province"==e){if(n={regionType:e,provinceName:t.name},this.state.regionType==n.regionType&&this.state.provinceName==n.provinceName)return}else if("municipality"==e&&(n={regionType:e,provinceName:t.provinceName,muniName:t.muniName,muniCode:t.muniCode},this.state.regionType==n.regionType&&this.state.provinceName==n.provinceName&&this.state.newState==n.muniName))return;var a=new CustomEvent(y,{detail:n});document.dispatchEvent(a),this.setState(n)}},{key:"getRegionName",value:function(){return"national"==this.state.regionType?"South Africa":"province"==this.state.regionType?this.state.provinceName:"municipality"==this.state.regionType?this.state.muniName:"municipality-vd"==this.state.regionType?this.state.muniName+"-"+this.state.vdNumber:void 0}},{key:"getContainer",value:function(){return d.i(this.refs.vizcontainer)}},{key:"getLoadingSpinner",value:function(){return d.i(this.refs.loading)}},{key:"render",value:function(){this.state.disableNavigation;return i.a.createElement("div",{className:"map-container"},this.getRegionName(),i.a.createElement("div",{className:"loading-spinner",ref:"loading"},i.a.createElement(ne.a,{type:"spin",color:"#777",height:100,width:100})),i.a.createElement("div",{ref:"vizcontainer",style:{display:"hidden"},className:"map"}))}},{key:"drawGraph",value:function(e,t){var n=this,a="province_lo-res.geojson";var i,r=z.DOMAIN+"/mapdata/"+function(){switch(n.state.regionType){case"national":return a;case"province":return{Limpopo:"lim_lo-res.geojson",Mpumalanga:"mp_lo-res.geojson",Gauteng:"gt_lo-res.geojson","KwaZulu-Natal":"kzn_lo-res.geojson","North West":"nw_lo-res.geojson","Free State":"fs_lo-res.geojson","Eastern Cape":"ec_lo-res.geojson","Northern Cape":"nc_lo-res.geojson","Western Cape":"wc_lo-res.geojson"}[n.state.provinceName];case"municipality":return n.state.muniCode+".topojson";default:return null}}();n.getLoadingSpinner().style("display","block").transition().duration(200).style("opacity",1),i=document.getElementsByClassName("tooltip")[0]?d.i(".tooltip"):d.i("body").append("div").attr("class",ie("tooltip")).style("opacity",0),console.log("process.env",Object({NODE_ENV:"production",PUBLIC_URL:"."}));e.selectAll("svg").remove();var o=e.append("svg").attr("preserveAspectRatio","xMinYMin meet").style("background-color","#ffffff").attr("viewBox","0 0 900 800").classed("svg-content",!0),l=[d.f(r),function(e){var t=e.eventDescription;if(t){if("national"==e.regionType)return V.query({query:O()(P(),t)});if("province"==e.regionType)return V.query({query:O()(k(),t,e.provinceName)});if("municipality"==e.regionType){var n=e.muniName.split(" - ")[1];return V.query({query:O()(j(),t,n)})}}}(t)];if(!Y){var c=B();l.push(c)}Promise.all(l).then(function(e){var a=e[0],l=function(e,t){if(!e)return null;var n={},a=t.regionType;return console.log("parseMainPartyData",e,a),"national"===a?e.data.allProvincialBallots.edges.forEach(function(e){var t=e.node,a=t.location.name,i=(t.partyResults||t.topResult).edges[0].node.party.name;n[a]=i}):"province"===a?e.data.allMunicipalBallots.edges.forEach(function(e){var t=e.node,a=t.location.code,i=(t.partyResults||t.topResult).edges[0].node.party.name;n[a]=i}):e.data.allVotingDistrictBallots.edges.forEach(function(e){var t=e.node,a=t.location.vdNumber,i=(t.partyResults||t.topResult).edges[0].node.party.name;n[a]=i}),n}(e[1],t);Y=Y||e[2];var c,s={};Y&&Y.data.allParties.edges&&Y.data.allParties.edges.forEach(function(e){s[e.node.name]=e.node.colour}),-1!==r.indexOf(".topojson")&&(a=X.a(a,a.objects[n.state.muniCode])),c=a.features;var u=d.d().fitSize([900,800],a),p=d.e().projection(u);if(o.selectAll(".".concat(ie("region"))).data(c).enter().append("path").attr("class",ie("region")).attr("stroke","#eeeeee").attr("fill",function(e,t){var a,i,r=n.state.regionType;if("national"===r){var o=e.properties.SPROVINCE;a=l[o],console.log("mainParty",a,o),console.log("partyColor",p)}else if("province"===r){var c=(i=e.properties).code||i.smunicipal.split("-")[0].replace(/\s/g,"");a=l[c]}else{var u=function(e){return e.PKLVDNUMBE}(e.properties);a=l[u]}var p=function(e){return e&&s[e.split("/")[0]]||ae}(a);return p}).attr("id",function(e,t){return"region-".concat(t)}).attr("d",p),"municipality"!==n.state.regionType&&o.selectAll(".place-label").data(c).enter().append("text").attr("class","place-label").attr("font-size","12px").attr("transform",function(e){var t,n;return"Polygon"===e.geometry.type?(t=Z()(e.geometry.coordinates),(n=u(t))[1]-=12,"translate("+n+")"):(t=Z()(e.geometry.coordinates[0]),(n=u(t))[1]-=5,"translate("+n+")")}).attr("dy",".35em").style("text-anchor","middle").text(function(e){return"national"===n.state.regionType?e.properties.SPROVINCE:"province"===n.state.regionType?e.properties.smunicipal.split("-")[1].split("[")[0]:e.properties.SMUNICIPAL.split("-")[1].split("[")[0]}),"municipality"!==n.state.regionType){var m,v=document.getElementsByClassName("place-label"),g={},h={};for(m=0;m<c.length;m++)g[m]=v[m].getBoundingClientRect();for(m=0;m<c.length;m++){for(var f=0;f<m;f++){var b=g[m],N=g[f];!(b.right<N.left||b.left>N.right||b.bottom<N.top||b.top>N.bottom)&&(h[m]=h[m]?h[m]+1:1)}h[m]>2?v[m].setAttribute("opacity",0):h[m]>0&&(v[m].innerHTML=v[m].innerHTML.slice(0,3)+"...")}}(o.selectAll(".eventLayer").data(c).enter().append("path").attr("d",p).attr("class","eventLayer").attr("id",function(e,t){return"eventLayer-".concat(t)}).attr("fill","transparent").on("mouseover",function(e,t){d.i("#region-".concat(t)).attr("stroke-width",3).style("fill-opacity",.8)}).on("mousemove",function(e){"municipality"!==n.state.regionType&&(i.transition().duration(200).style("opacity",1),i.html("national"===n.state.regionType?e.properties.SPROVINCE:"province"===n.state.regionType?e.properties.smunicipal.split("-")[1].split("[")[0]:e.properties.SMUNICIPAL.split("-")[1].split("[")[0]).style("left",d.c.pageX+"px").style("top",d.c.pageY-28+"px"))}).on("mouseout",function(e,t){d.i("#region-".concat(t)).attr("stroke-width",1).style("fill-opacity",1),"municipality"!==n.state.regionType&&i.transition().duration(200).style("opacity",0)}).on("click",function(e,t){if(!n.state.disableNavigation){i.transition().duration(200).style("opacity",0);var a,r=n.state.regionType;if("national"===r)o={regionType:"province",provinceName:e.properties.SPROVINCE},l=new CustomEvent(y,{detail:o}),document.dispatchEvent(l),n.setState(o);else if("province"===r){o={regionType:"municipality",provinceName:n.state.provinceName,muniName:e.properties.smunicipal,muniCode:(a=e.properties,a.code||a.smunicipal.split("-")[0].replace(/\s/g,""))},l=new CustomEvent(y,{detail:o}),document.dispatchEvent(l),n.setState(o)}else{var o={regionType:"municipality-vd",provinceName:n.state.provinceName,muniName:n.state.muniName,muniCode:n.state.muniCode,vdNumber:function(e){return e.PKLVDNUMBE}(e.properties)},l=new CustomEvent(y,{detail:o});document.dispatchEvent(l)}}}),n.state.disableNavigation)||o.append("foreignObject").attr("x",800).attr("y",10).attr("width",100).attr("height",30).attr("class","map-controls").append("xhtml:div").append("button").attr("class","go-back").html("go back").on("click",function(){var e,t=n.state.regionType,a={regionType:n.state.regionType,provinceName:n.state.provinceName,muniName:n.state.muniName,muniImuniCodeD:n.state.muniCode,vdNumber:n.state.vdNumber};"province"===t?a.regionType="national":"municipality"===t&&(a.regionType="province"),e=new CustomEvent(y,{detail:a}),document.dispatchEvent(e),n.setState(a)});n.getLoadingSpinner().style("display","none")});window.addEventListener("resize",function(){},200)}}]),t}(a.Component),oe=n(51),le=n.n(oe);function ce(e){return G.a[e]||le.a[e]||e}var se=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={elementId:"root",disableNavigation:!1,regionType:"province",provinceName:"Western Cape",muniName:""},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){}},{key:"onRegionTypeChange",value:function(e){var t={regionType:e.target.value};this.setState(t)}},{key:"onPreview",value:function(e){var t=new CustomEvent(b,{detail:this.state});document.dispatchEvent(t)}},{key:"render",value:function(){var e=this,t=z.DOMAIN,n=this.state,a=n.elementId,r=n.disableNavigation,o=n.regionType,l=n.provinceName,c=n.muniName;return i.a.createElement("div",null,i.a.createElement("h3",null," Map Embed Script Generation "),i.a.createElement("div",{className:ce("form-group")},i.a.createElement("label",null,"Element ID "),i.a.createElement("input",{type:"text",className:ce("form-control"),placeholder:"chart-container",onChange:function(t){return e.setState({elementId:t.target.value})}})),i.a.createElement("div",{className:ce("form-group")},i.a.createElement("label",null,"Region Type "),i.a.createElement("select",{className:ce("form-control"),value:o,onChange:this.onRegionTypeChange.bind(this)},i.a.createElement("option",{value:"national"},"national"),i.a.createElement("option",{value:"province"},"province"),i.a.createElement("option",{value:"municipality"},"municipality"))),"national"!=o&&i.a.createElement("div",{className:ce("form-group")},i.a.createElement("label",null,"Province Name"),i.a.createElement("input",{type:"text",className:ce("form-control"),placeholder:"Western Cape",value:l,onChange:function(t){return e.setState({provinceName:t.target.value})}})),"municipality"==o&&i.a.createElement("div",{className:ce("form-group")},i.a.createElement("label",null,"Municipality Name"),i.a.createElement("input",{type:"text",className:ce("form-control"),placeholder:"City of Cape Town",value:c,onChange:function(t){return e.setState({muniName:t.target.value})}})),i.a.createElement("div",{className:ce("form-check")},i.a.createElement("label",{className:ce("form-check-label")},i.a.createElement("input",{type:"checkbox",className:ce("form-check-input"),value:r,onChange:function(t){return e.setState({disableNavigation:t.target.checked})}}),"\xa0\xa0Disable Navigation")),i.a.createElement("div",{className:ce("form-group")},i.a.createElement("button",{type:"button",onClick:this.onPreview.bind(this),className:ce("btn")+" "+ce("btn-primary")},"Preview")),i.a.createElement("div",{className:ce("form-group")},i.a.createElement("label",null,"Embed Code"),i.a.createElement("div",{className:ce("embedcode")},i.a.createElement("span",null,'<script src="'.concat(t,'/embed/embed.js"><\/script>\n                    <script>\n                        showMap(document.getElementById("').concat(a,'"),{\n                            disableNavigation: ').concat(r,',\n                            regionType: "').concat(o,'",\n                            provinceName: "').concat(l,'",\n                            muniName: "').concat(c,'",\n                        });<\/script>').replace(/(\r\n|\n|\r)/gm,"")))))}}]),t}(a.Component),ue=(n(90),a.Component,function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement("div",{className:"leftContainer"},i.a.createElement(q,{regionName:"South Africa",regionType:"national",numParties:3}),i.a.createElement(re,{regionType:"province",provinceName:"Western Cape"})),i.a.createElement("div",{className:"rightContainer"},i.a.createElement("div",{className:"barchartEmbed"},i.a.createElement(J,null)),i.a.createElement("div",{className:"mapEmbed"},i.a.createElement(se,null))),i.a.createElement("div",{id:"sales-data"}))}}]),t}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(ue,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[56,2,1]]]);
//# sourceMappingURL=main.17460619.chunk.js.map