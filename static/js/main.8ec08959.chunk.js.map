{"version":3,"sources":["events/index.js","api/index.js","components/BarChart/barchart.js","components/Map/map.js","App.js","components/Box/Box.js","serviceWorker.js","index.js"],"names":["events","client","ApolloClient","link","HttpLink","uri","useGETForQueries","headers","Content-Type","cache","InMemoryCache","chart","dataRefreshTime","predefBarChartColors","R","G","B","seed","className","originName","styles","Chart","container","width","height","predefColors","svg","append","attr","gradientName","rgb","concat","defineGradient","defs","originRGB","selectAll","data","enter","d","percent","mixedR","mixedG","mixedB","getMergedColorWithWhite","tooltipDiv","i","length","document","getElementsByClassName","d3","style","x","rangeRound","y","YaxisOffset","text","barSvg","barTextSvg","this","draw","chartData","domain","map","name","Number","value","select","transition","duration","call","ticks","tickSize","tickFormat","bars","exit","remove","bandwidth","on","html","pageX","pageY","barTexts","destroy","Component","Map","props","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","state","regionType","regionName","parentProvinceName","console","log","self","nationalMapFile","fullRouteGeoJsonFile","Limpopo","Mpumalanga","Gauteng","KwaZulu-Natal","North West","Free State","Eastern Cape","Northern Cape","Western Cape","getRegionFileName","JSON","stringify","process","indexOf","w","classed","geoJsonLoader","setState","Promise","all","then","values","getJsonDataFeatures","geoJsonData","topojson","objects","features","projection","fitSize","path","geometry","type","center","polylabel","coordinates","projectionCenter","properties","SPROVINCE","smunicipal","split","SMUNICIPAL","labelElements","regions","overlapCnt","getBoundingClientRect","j","rect1","rect2","right","left","bottom","top","setAttribute","innerHTML","slice","newState","event","CustomEvent","dispatchEvent","replace","getMunicipalityRegionName","window","addEventListener","drawGraph","getContainer","refs","vizcontainer","react_default","a","createElement","ref","App","Map_map","id","Boolean","location","hostname","match","ReactDOM","render","src_App_0","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.8ec08959.chunk.js","sourcesContent":["const REGION_CHANGE = 'region-change';\n\nexport default {\n    REGION_CHANGE\n};","import { ApolloClient } from 'apollo-client'\nimport { HttpLink } from 'apollo-link-http'\nimport { InMemoryCache } from 'apollo-cache-inmemory'\nimport gql from 'graphql-tag'\n\nconst client = new ApolloClient({\n  link: new HttpLink({ uri: 'http://elections2019.xyz/graphql', useGETForQueries: true, headers: {\"Content-Type\" : \"application/graphql\" } }),\n  cache: new InMemoryCache()\n})\n\n\nexport function getVotesData(options) {\n    return client.query({\n        query: gql`\n        {\n          allProvincialBallots(\n              event_Description_Icontains:\"2004\", \n            event_EventType_Description_Icontains:\"National\",\n            location_Name:\"${options.regionName}\"\n        \n          ) {\n            edges {\n              node {\n                topResult(validVotes_Gt:1000, last:${options.numParties}) {\n                  edges {\n                    node {\n                      validVotes\n                      party {\n                        name\n                        abbreviation\n                      }\n                    }\n                  }\n                }\n                location {\n                  name\n                }\n              }\n            }\n          }\n        }\n        `,\n      });\n}","import React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport styles from './barchart.css';\n\nimport events from '../../events';\nimport {\n  getVotesData\n} from '../../api';\n\nvar dataRefreshTime = 30 * 100;\nvar predefBarChartColors = [\n  {R: 0, G: 114, B: 47},\n  {R: 3, G: 62, B: 108},\n  {R: 131, G: 23, B: 27},\n  {R: 170, G: 0, B: 14},\n  {R: 76, G: 114, B: 114},\n  {R: 191, G: 135, B: 50},\n];\nvar seed = 1;\n\n// for the purposes of the proof of concept - production data should be live\nvar use_live_data = true;\nvar js = {\n  \"data\": {\n    \"allProvincialBallots\": {\n      \"edges\": [\n        {\n          \"node\": {\n            \"location\": {\n              \"name\": \"Western Cape\"\n            },\n            \"topResult\": {\n              \"edges\": [\n                {\n                  \"node\": {\n                    \"party\": {\n                      \"abbreviation\": \"VF Plus\",\n                      \"name\": \"VRYHEIDSFRONT PLUS\"\n                    },\n                    \"validVotes\": 23243\n                  }\n                },\n                {\n                  \"node\": {\n                    \"party\": {\n                      \"abbreviation\": \"ACDP\",\n                      \"name\": \"AFRICAN CHRISTIAN DEMOCRATIC PARTY\"\n                    },\n                    \"validVotes\": 25318\n                  }\n                },\n                {\n                  \"node\": {\n                    \"party\": {\n                      \"abbreviation\": \"EFF\",\n                      \"name\": \"ECONOMIC FREEDOM FIGHTERS\"\n                    },\n                    \"validVotes\": 50280\n                  }\n                },\n                {\n                  \"node\": {\n                    \"party\": {\n                      \"abbreviation\": \"ANC\",\n                      \"name\": \"AFRICAN NATIONAL CONGRESS\"\n                    },\n                    \"validVotes\": 737219\n                  }\n                },\n                {\n                  \"node\": {\n                    \"party\": {\n                      \"abbreviation\": \"DA\",\n                      \"name\": \"DEMOCRATIC ALLIANCE/DEMOKRATIESE ALLIANSIE\"\n                    },\n                    \"validVotes\": 1241424\n                  }\n                }\n              ]\n            }\n          }\n        }\n      ]\n    }\n  }\n}\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nfunction Chart(container, width, height) {\n  var XaxisOffset = 70;\n  var YaxisOffset = 20;\n  var predefColors = predefBarChartColors;\n  var svg = container.append(\"svg\")\n      .attr(\"width\", width + XaxisOffset)\n      .attr(\"height\", height + YaxisOffset);\n\n  function gradientName(rgb) {\n    return `gradientrgb-${rgb.R}-${rgb.G}-${rgb.B}`;\n  }\n\n  function defineGradient(defs, originRGB) {\n    function getMergedColorWithWhite(percent) {\n      var mixedR = (originRGB.R * (100-percent) + 255 * (percent))/100;\n      var mixedG = (originRGB.G * (100-percent) + 255 * (percent))/100;\n      var mixedB = (originRGB.B * (100-percent) + 255 * (percent))/100;\n      return `rgb(${mixedR},${mixedG},${mixedB})`;\n    }\n    var linearGradient = defs.append(\"linearGradient\")\n      .attr(\"id\", gradientName(originRGB));\n    var gradientInfo = [[0,0], [11, 92], [25,15], [82, 35], [100, 4]];\n    linearGradient.selectAll(\"stop\")\n      .data(gradientInfo)\n      .enter()\n      .append('stop')\n      .attr(\"offset\", d => d[0]+'%')\n      .attr(\"stop-color\", d => getMergedColorWithWhite(d[1]))\n      .attr(\"stop-opacity\", 1);\n  }\n\n  var defs = svg.append(\"defs\");\n  for (var i = 0; i < predefColors.length; i ++)\n    defineGradient(defs, predefColors[i]);\n\n  var tooltipDiv;\n  if (document.getElementsByClassName('tooltip')[0]) {\n    tooltipDiv = d3.select(\".tooltip\");\n  } else {\n    tooltipDiv = d3.select(\"body\").append(\"div\")\t\n      .attr(\"class\", className(\"tooltip\"))\t\t\t\t\n      .style(\"opacity\", 0);\n  }\n\n  var x = d3.scaleBand()\n    .rangeRound([XaxisOffset, width])\n\n  var y = d3.scaleLinear()\n    .rangeRound([height, YaxisOffset]);\n\n  svg.append(\"g\")\n    .attr(\"transform\", \"translate(20,\"+(height/2+YaxisOffset/2)+\")\")\n    .append(\"text\")\n    .attr(\"class\", className(\"percentage-label\"))\n    .attr(\"transform\", \"rotate(-90)\")\n    .text(\"PERCENTAGE VOTES\")\n    .attr(\"text-anchor\", \"middle\");\n\n  svg.append(\"g\")\n    .attr(\"class\", \"x axis\")\n    .attr(\"transform\", \"translate(0,\" + height + \")\")\n\n  svg.append(\"g\")\n    .attr(\"class\", \"y axis\")\n    .attr(\"transform\", \"translate(\" + XaxisOffset +\", 0)\")\n\n  svg.append(\"g\")\n    .attr(\"class\", className(\"grid\"))\n    .attr(\"transform\", \"translate(\" + XaxisOffset +\", 0)\")\n\n  var barSvg = svg.append(\"g\")\n    .attr(\"class\", className(\"bar-container\"));\n  var barTextSvg = svg.append(\"g\")\n    .attr(\"class\", className(\"bartext-container\"));\n\n  this.draw = function(chartData) {\n    x.domain(chartData.map(function (d) {\n        return d.name;\n      }));\n    y.domain([0, d3.max(chartData, function (d) {\n          return Number(d.value);\n        })]);\n\n\n\t\tsvg.select('.x.axis').transition().duration(300).call(d3.axisBottom(x));\n\t\tsvg.select(\".y.axis\").transition().duration(300).call(d3.axisLeft(y)\n      .ticks(6)\n      .tickSize(-width+XaxisOffset)\n    )\n    svg.select(\".grid\").transition().duration(300).call(d3.axisLeft(y)\n      .ticks(6)\n      .tickSize(-width+XaxisOffset)\n      .tickFormat(\"\")\n    )\n\n    var bars = barSvg.selectAll(`.${className(\"bar\")}`).data(chartData);\n\n    bars.exit()\n      .transition()\n      .duration(300)\n      .attr(\"y\", function(d) {\n        return y(0);\n      })\n      .attr(\"height\", 0)\n      .style('fill-opacity', 1e-6)\n      .remove();\n\n    bars.enter()\n        .append(\"rect\")\n        .attr(\"class\", className(\"bar\"))\n        .attr(\"x\", function (d) {\n          return x(d.name)+x.bandwidth()/20;\n        })\n        .attr(\"width\", x.bandwidth()*9/10)\n        .attr(\"fill\", (d, i) =>`url(#${gradientName(predefColors[i%predefColors.length])})`)\n        .on(\"mousemove\", function(d) {\t\t\n            d3.select(this)\n              .attr(\"opacity\", 0.8);\n            tooltipDiv.transition()\t\t\n                .duration(200)\t\t\n                .style(\"opacity\", .9);\t\t\n            tooltipDiv.html(d.name + ' : ' + d.value)\t\n                .style(\"left\", (d3.event.pageX) + \"px\")\t\t\n                .style(\"top\", (d3.event.pageY - 28) + \"px\");\t\n            })\t\t\t\t\t\n        .on(\"mouseout\", function(d) {\t\t\n            d3.select(this)\n              .attr(\"opacity\", 1);\n            tooltipDiv.transition()\t\t\n                .duration(200)\t\t\n                .style(\"opacity\", 0);\t\n        })\n        .attr(\"y\", function(d) {\n          return y(0);\n        })\n        .attr(\"height\", 0)        \n\n      barSvg.selectAll(`.${className(\"bar\")}`).data(chartData)\n        .transition()\n        .duration(300)\n        .attr(\"y\", function (d) {\n          return y(Number(d.value));\n        })\n        .attr(\"height\", function (d) {\n          return height - y(Number(d.value));\n        })\n        \n      var barTexts = barTextSvg.selectAll(`.${className(\"bartext\")}`).data(chartData);\n\n      barTexts.exit()\n        .transition()\n        .duration(300)\n        .attr(\"y\", function(d) {\n          return y(0) - 5;\n        })\n        .style('fill-opacity', 1e-6)\n        .remove();\n\n      barTexts.enter().append(\"text\")\n        .attr(\"class\", className(\"bartext\"))\n        .attr(\"x\", function (d) {\n          return x(d.name)+x.bandwidth()/2;\n        })\n        .attr('text-anchor', 'middle')\n        .attr('font-size', '12px')\n        .attr(\"y\", function(d) {\n          return y(0) - 5;\n        })\n      barTextSvg.selectAll(`.${className(\"bartext\")}`).data(chartData)\n        .text(function(d) {\n          return d.value;\n        })\n        .transition()\n        .duration(300)\n        .attr(\"y\", function (d) {\n          return y(Number(d.value)) - 5;\n        })\n  }\n  this.destroy = function() {\n    svg.remove();\n  }\n}\n\nvar chart;\n\nclass BarChart extends Component {\n\n    constructor(props) {\n      super(props);\n      var self = this;\n      this.state = {\n        numParties: 5,\n        regionName: \"Western Cape\",\n        width: 600,\n        height: 220\n      }\n      if (props.numParties) {\n        this.state.numParties = props.numParties;\n      }\n      if (props.regionName) {\n        this.state.regionName = props.regionName;\n      }\n      if (props.width) {\n        this.state.width = props.width;\n      }\n      if (props.height) {\n        this.state.height = props.height;\n      }\n      setInterval(() => {\n        self.draw(self.getContainer(), self.state)\n      }, dataRefreshTime);\n      this.handleRegionChange = this.handleRegionChange.bind(this);\n      this.redrawChart = this.redrawChart.bind(this);\n    }\n  \n    componentDidMount() {\n      this.draw(this.getContainer(), this.state)\n      document.addEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      window.addEventListener(\"resize\", this.redrawChart, 200);\n    }\n\n    componentDidUpdate() {\n      this.draw(this.getContainer(), this.state)\n    }\n\n    componentWillUnmount() {\n      document.removeEventListener(events.REGION_CHANGE, this.handleRegionChange);\n      window.removeEventListener(\"resize\", this.redrawChart);\n    }\n\n    redrawChart() {\n      var modifW = document.body.clientWidth, modifH = document.body.clientHeight/3;\n      chart.destroy();\n      chart = new Chart(this.getContainer(), modifW, modifH);\n      this.setState({width: modifW, height: modifH});\n    };\n\n    handleRegionChange(event) {\n      this.setState({regionName: \"Eastern Cape\"})\n    }\n\n    getContainer() {\n      return d3.select(this.refs.vizcontainer)\n    }\n      \n    render () {\n      return (\n          <div>\n            <div className={className(\"chart-title\")}>RACE FOR VOTES: </div>\n            <div ref=\"vizcontainer\" className={className(\"chart-body\")}></div>\n          </div>\n        )\n    }\n\n    draw(container, props) {\n      var self = this;\n      if (use_live_data) {\n        getVotesData({\n          numParties: props.numParties || 5,\n          regionName: props.regionName || \"Western Cape\"\n        }).then(function(data) {\n            self.drawGraph(container, props, data);\n        }).catch(error => console.error(error));\n      }\n      else {\n          self.drawGraph(container, props, js);\n      }\n    }\n\n    drawGraph(container, props, data) {\n        var chartData;\n        var results = data[\"data\"][\"allProvincialBallots\"].edges[0][\"node\"][\"topResult\"][\"edges\"];\n        chartData = results.map(function(node) {\n            var el = node[\"node\"];\n            return {\n                name: el[\"party\"][\"abbreviation\"],\n                value: el[\"validVotes\"] + parseInt(Math.random(seed++) * 0.1 * el[\"validVotes\"])\n            }\n        }).reverse();\n\n        var width = parseInt(props.width);\n        var height = parseInt(props.height);\n        if (!chart)\n          chart = new Chart(container, width, height);\n        chart.draw(chartData);\n    }\n}\n\nexport default BarChart;\n","import React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport * as topojson from 'topojson-client';\nimport polylabel from 'polylabel';\nimport styles from './map.css';\nimport events from '../../events';\n\nfunction className(originName) {\n  return styles[originName] || originName;\n}\n\nclass Map extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n          regionType: \"national\",\n          regionName: \"SA\",\n          parentProvinceName: \"\"\n        }\n\n        if (props.regionType) {\n            this.state.regionType = props.regionType;\n        }\n        if (props.regionName) {\n            this.state.regionName = props.regionName;\n        }\n    }\n\n\n\n    drawGraph(container, props) {\n        console.log(\"drawGraph\", \"new\", this);\n        var self = this;\n        var nationalMapFile = \"province_lo-res.geojson\";\n\n        function getRegionFileName() {\n            function getProvinceFileName(regionName) {\n                console.log(\"getProvinceFileName\", regionName);\n                var provinceNameToFileMap = {\n                    \"Limpopo\": \"lim_lo-res.geojson\",\n                    \"Mpumalanga\": \"mp_lo-res.geojson\",\n                    \"Gauteng\": \"gt_lo-res.geojson\",\n                    \"KwaZulu-Natal\": \"kzn_lo-res.geojson\",\n                    \"North West\": \"nw_lo-res.geojson\",\n                    \"Free State\": \"fs_lo-res.geojson\",\n                    \"Eastern Cape\": \"ec_lo-res.geojson\",\n                    \"Northern Cape\": \"nc_lo-res.geojson\",\n                    \"Western Cape\": \"wc_lo-res.geojson\",\n                }\n                return provinceNameToFileMap[regionName];\n            }\n            switch(self.state.regionType) {\n                case \"national\":\n                    return nationalMapFile;\n                case \"province\":\n                    return getProvinceFileName(self.state.regionName);\n                case \"municipality\":\n                    return self.state.regionName + \".topojson\";\n            }\n        }\n\n        // var geoJSONFileNames = [\n        //     \"province_hires.geojson\", // high resolution national { \"SPROVINCE\": \"Mpumalanga\", \"PKLVDNUMBE\": 54100011.0 }\n        //     \"province_lo-res.geojson\",// low resolution national {\"SPROVINCE\":\"Limpopo\",\"PKLVDNUMBE\":54520017}\n        //     \"ec_lo-res.geojson\",\n        //     \"fs_lo-res.geojson\",\n        //     \"gt_lo-res.geojson\",\n        //     \"kzn_lo-res.geojson\",\n        //     \"lim_lo-res.geojson\",\n        //     \"mp_lo-res.geojson\",\n        //     \"nc_lo-res.geojson\",\n        //     \"nw_lo-res.geojson\", //low resolution northwest {\"smunicipal\":\"NW372 - Madibeng [Brits]\"}\n        //     \"wc_lo-res.geojson\",\n        //     // BUF.topojson\n        //     // CPT.topojson\n        //     // EC101.topojson ... EC444.topojson\n        //     // EKU.topojson\n        //     // ETH.topojson\n        //     // FS161.topojson ... FS205.topojson\n        //     // GT421.topojson ... GT484.topojson\n        //     // JHB.topojson\n        //     // KZN211.topojson ... KZN435.topojson\n        //     // LIM331.topojson ... LIM475.topojson\n        //     // MAN.topojson\n        //     // MP301.topojson ... MP325.topojson\n        //     // NC061.topojson ... NC453.topojson\n        //     // NMA.topojson\n        //     // NW371.topojson ... NW404.topojson\n        //     // TSH.topojson\n        //     // WC011.topojson ... WC053.topojson\n        // ];\n        var fullRouteGeoJsonFile = \"/mapdata/\" + getRegionFileName();\n\n        var tooltipDiv;\n        if (document.getElementsByClassName('tooltip')[0]) {\n          tooltipDiv = d3.select(\".tooltip\");\n        } else {\n          tooltipDiv = d3.select(\"body\").append(\"div\")\t\n            .attr(\"class\", className(\"tooltip\"))\t\t\t\t\n            .style(\"opacity\", 0);\n        }\n\n        if (JSON.stringify(process.env).indexOf(\"docz\") != -1) {\n            fullRouteGeoJsonFile = \"/public\" + fullRouteGeoJsonFile;\n        }\n\n        console.log(\"fullRouteGeoJsonFile\", fullRouteGeoJsonFile);\n\n        var w = 1400;\n        var h = 700;\n        container.selectAll(\"svg\").remove();\n        var svg = container.append(\"svg\")\n            .attr(\"preserveAspectRatio\", \"xMinYMin meet\").style(\"background-color\",\"#c9e8fd\")\n            .attr(\"viewBox\", \"0 0 \" + w + \" \" + h)\n            .classed(\"svg-content\", true);\n\n        var fo = svg.append('foreignObject')\n            .attr('x', w - 100)\n            .attr('y', 10)\n            .attr('width', 100)\n            .attr('height', 30)\n            .attr('class', 'map-controls')\n        var gobackbutton = fo.append('xhtml:div')\n            .append('button')\n            .attr('class', 'go-back')\n            .html('go back')\n            .on(\"click\", function() {\n                var regionType = self.state.regionType;\n                if (regionType == \"province\") {\n                    self.setState({regionType: \"national\", regionName: \"SA\"});\n                } else if (regionType == \"municipality\") {\n                    function getProvinceFromMunicipality(municipalityName) {\n                        return self.state.parentProvinceName;\n                    }\n                    self.setState({\n                        regionType: \"province\", \n                        regionName: getProvinceFromMunicipality(self.regionName)\n                    });\n                }\n            });\n\n        var geoJsonLoader = d3.json(fullRouteGeoJsonFile);\n\n        Promise.all([geoJsonLoader]).then(function(values){ \n\n            console.log(\"json load Finished\");\n            var geoJsonData = values[0];\n\n            var getJsonDataFeatures;\n            if (fullRouteGeoJsonFile.indexOf(\".topojson\") != -1) {\n                geoJsonData = topojson.feature(geoJsonData, geoJsonData.objects[self.state.regionName]);\n            }\n\n            getJsonDataFeatures = geoJsonData.features;\n\n            console.log(\"getJsonDataFeatures\", getJsonDataFeatures);\n\n\n            var projection = d3.geoMercator().fitSize([w, h], geoJsonData);\n            var path = d3.geoPath().projection(projection);\n\n            // fill region with green\n            svg.selectAll(`.${className(\"region\")}`)\n                .data(getJsonDataFeatures)\n                .enter()\n                .append(\"path\")\n                .attr(\"class\", className(\"region\"))\n                .attr('stroke', \"#FFF\")\n                .attr(\"fill\", \"green\")\n                .attr(\"id\", function(d, i) {\n                    return `region-${i}`;\n                })\n                .attr(\"d\", path);\n            \n            //show place label\n            svg.selectAll(\".place-label\")\n                .data(getJsonDataFeatures)\n            .enter().append(\"text\")\n                .attr(\"class\", \"place-label\")\n                .attr(\"font-size\", \"12px\")\n                .attr(\"transform\", function(d) { \n                    if (d.geometry.type == \"Polygon\") {\n                        var center = polylabel(d.geometry.coordinates);\n                        console.log(\"center\", center);\n                        var projectionCenter = projection(center);\n                        projectionCenter[1] -= 12;\n                        return \"translate(\" + projectionCenter + \")\"; \n                    } else { //d.geometry.type == \"MultiPolygon\"\n                        var center = polylabel(d.geometry.coordinates[0]);\n                        var projectionCenter = projection(center);\n                        projectionCenter[1] -= 5;\n                        //projection(center)\n                        return \"translate(\" + projectionCenter + \")\"; \n                    }\n                })\n                .attr(\"dy\", \".35em\")\n                .style(\"text-anchor\", \"middle\")\n                .text(function(d) { \n                    if (self.state.regionType == \"national\") {\n                        return d.properties.SPROVINCE;\n                    } else if (self.state.regionType == \"province\") {\n                        return d.properties.smunicipal.split(\"-\")[1].split(\"[\")[0]; \n                    } else {//municipality\n                        return d.properties.SMUNICIPAL.split(\"-\")[1].split(\"[\")[0]; \n                    }\n                })\n\n            var labelElements = document.getElementsByClassName(\"place-label\");\n\n            var regions = {};\n            var overlapCnt = {};\n            for (var i = 0; i < getJsonDataFeatures.length; i ++) {\n                regions[i] = labelElements[i].getBoundingClientRect();\n            }\n\n            for (var i = 0; i < getJsonDataFeatures.length; i ++) {\n                for (var j = 0; j < i; j ++) {\n                    var rect1 = regions[i];\n                    var rect2 = regions[j];\n                    var overlap = !(rect1.right < rect2.left || \n                        rect1.left > rect2.right || \n                        rect1.bottom < rect2.top || \n                        rect1.top > rect2.bottom);\n                    if (overlap) {\n                        overlapCnt[i] = overlapCnt[i]? (overlapCnt[i] + 1): 1;\n                    }\n                }\n                if (overlapCnt[i] > 2) {\n                    labelElements[i].setAttribute(\"opacity\", 0)\n                } else if (overlapCnt[i] > 0){\n                    labelElements[i].innerHTML = labelElements[i].innerHTML.slice(0, 3) + \"...\";\n                } else {\n\n                }\n            }\n            for (var i = 0; i < getJsonDataFeatures.length; i ++) {\n                // labelElements[i].setAttribute(\"font-size\", 12 / overlapCnt[i]);\n                \n            }\n            \n            console.log(\"regions\", overlapCnt);\n\n\n            // placeLabelText.append('tspan')\n            //     .attr(\"x\", 0)\n            //     .attr(\"dy\", '0em')\n            //     .text(function(d) { \n            //         if (self.state.regionType == \"national\") {\n            //             return d.properties.SPROVINCE;\n            //         } else if (self.state.regionType == \"province\") {\n            //             return d.properties.smunicipal.split(\"-\")[1].split(\"[\")[0]; \n            //         } else {//municipality\n            //             return d.properties.SMUNICIPAL.split(\"-\")[1].split(\"[\")[0]; \n            //         }\n            //     });\n            // placeLabelText.append('tspan')\n            //     .attr(\"x\", 0)\n            //     .attr(\"dy\", '1em')\n            //     .text(function(d) { \n            //         if (d.properties.SPROVINCE) \n            //             return \"\";\n            //         return \"[\" + d.properties.smunicipal.split(\"-\")[1].split(\"[\")[1]; \n            //     });\n            \n\t\t\t\t\n            //hidden area for catching events\n            svg.selectAll(\".eventLayer\")\n                .data(getJsonDataFeatures)\n            .enter()\n                .append(\"path\")\n                .attr(\"d\", path)\n                .attr(\"class\", \"eventLayer\")\n                .attr(\"id\", function(d, i) {\n                    return `eventLayer-${i}`;\n                })\n                .attr(\"fill\", \"transparent\")\n                .on('mouseover', function(d, i) {\n                    d3.select(`#region-${i}`)\n                        .attr('stroke-width', 3)\n                        .style('fill-opacity', 0.8);\n                })\n                .on(\"mousemove\", function(d) {\t\t\n                    tooltipDiv.transition()\t\t\n                        .duration(200)\t\t\n                        .style(\"opacity\", 1);\n                    function regionName() {\n                        if (self.state.regionType == \"national\") {\n                            return d.properties.SPROVINCE;\n                        } else if (self.state.regionType == \"province\") {\n                            return d.properties.smunicipal.split(\"-\")[1].split(\"[\")[0]; \n                        } else {//municipality\n                            return d.properties.SMUNICIPAL.split(\"-\")[1].split(\"[\")[0]; \n                        }\n                    }\n                    tooltipDiv.html(regionName())\t\n                        .style(\"left\", (d3.event.pageX) + \"px\")\t\t\n                        .style(\"top\", (d3.event.pageY - 28) + \"px\");\t\n                })\n                .on('mouseout', function(d, i) {\n                    d3.select(`#region-${i}`)\n                        .attr('stroke-width', 1)\n                        .style('fill-opacity', 1);\n                    \n                    tooltipDiv.transition()\t\t\n                        .duration(200)\t\t\n                        .style(\"opacity\", 0);\t\n                })\n                .on(\"click\", function(d, i) {\n                    console.log(\"click event\", i, d.properties);\n                    \n                    var regionType = self.state.regionType;\n                    if (regionType == \"national\") {\n                        var newState = {\n                            regionType: \"province\",\n                            regionName: d.properties.SPROVINCE\n                        }\n                        var event = new CustomEvent(events.REGION_CHANGE, newState);\n                        document.dispatchEvent(event);\n                        self.setState(newState);\n                    } else if (regionType == \"province\") {\n                        function getMunicipalityName(properties) {\n                            return properties.smunicipal.split(\"-\")[0].replace(/\\s/g, \"\");\n                        }\n                        var newState = {\n                            regionType: \"municipality\", \n                            regionName: getMunicipalityName(d.properties),\n                            parentProvinceName: self.state.regionName\n                        }\n                        var event = new CustomEvent(events.REGION_CHANGE, newState);\n                        document.dispatchEvent(event);\n\n                        self.setState(newState);\n                    } else {\n                        function getMunicipalityRegionName(properties) {\n                            return properties.SMUNICIPAL.split(\"-\")[0].replace(/\\s/g, \"\");\n                        }\n                        var newState = {\n                            regionType: \"municipality-region\", \n                            regionName: getMunicipalityRegionName(d.properties),\n                        }\n                        var event = new CustomEvent(events.REGION_CHANGE, newState);\n                        document.dispatchEvent(event);\n                    }\n                })\n            console.log(\"svg drawing finished\");\n        })\n\n        var redrawChart = function() {\n\n        };\n\n        window.addEventListener(\"resize\", redrawChart, 200);\n    }\n\n    draw(container, props) {\n        this.drawGraph(container, props);\n    }\n\n    componentDidMount() {\n        this.draw(this.getContainer(), this.props)\n    }\n\n    componentDidUpdate() {\n        this.draw(this.getContainer(), this.props)\n    }\n\n    getContainer() {\n        return d3.select(this.refs.vizcontainer)\n    }\n      \n    render () {\n        return (\n            <div>\n                <div>{this.state.regionName}</div>\n                <div ref=\"vizcontainer\" className=\"map\"></div>\n            </div>\n        )\n    }\n}\n\nexport default Map;\n","import React, { Component } from 'react';\nimport './App.css';\nimport {\n  BarChart,\n  Map\n} from './components';\n\nclass App extends Component {\n  render() {\n    return (\n      <div className=\"App\">\n        {/* <BarChart width=\"600\" height=\"220\" regionName=\"Western Cape\" numParties={3}/> */}\n        <Map />\n        <div id=\"sales-data\"></div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React, { Component } from 'react';\nimport * as d3 from 'd3'\nimport './Box.css';\n\nclass Box extends Component {\n    draw() {\n        d3.select(this.refs.box)\n            .append(\"rect\")\n            .attr(\"height\", this.props.height)\n            .attr(\"width\", this.props.width)\n            .classed(this.props.className, true)\n            .classed(\"box\", true)\n    }\n\n    componentDidMount() {\n        this.draw()\n    }\n\n    componentDidUpdate() {\n        this.draw()\n    }\n      \n    render () {\n        return (\n          <svg width={this.props.width} height={this.props.height}>\n            <g ref=\"box\"></g>\n          </svg>\n        )\n    }\n}\n\nexport default Box;\n\n\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}